/* 
 * File:   intralayer_coupling.cpp
 * Author: Stephen
 * 
 * Created on February 5, 2016, 3:33 PM
 */

 
#include "intralayer_coupling.h"
#include <stdio.h>
#include <cmath>



double intralayer_term(double x1, double y1, double z1, double x2, double y2, double z2, int orbit1, int orbit2, int mat){
	
	// bilayer graphene
	if (mat == 0){
		return intralayer_graphene(x1, y1, z1, x2, y2, z2);
	}
	
	// bilayer tmdc
	if (mat > 0 & mat < 5){
		return intralayer_tmdc(x1, y1, z1, x2, y2, z2, orbit1, orbit2, mat);
	}
	
	printf("failed to find intra-coupling term. \n");
	return 0;
		
}

double intralayer_graphene(double x1, double y1, double z1, double x2, double y2, double z2){

	double delta = 0.1;
	double alpha = 2.4768;
	double alpha2 = alpha*alpha;

	double r_sq = (x2 - x1)*(x2 - x1) + (y2 - y1)*(y2 - y1);

	double t_arr[8];
	t_arr[0] = -2.8922;
	t_arr[1] =  0.2425;
	t_arr[2] = -0.2656;
	t_arr[3] =  0.0235;
	t_arr[4] =  0.0524;
	t_arr[5] = -0.0209;
	t_arr[6] = -0.0148;
	t_arr[7] = -0.0211;

	double r_sq_arr[8];
	r_sq_arr[0] = (1.0/3.0)*alpha2;
	r_sq_arr[1] = alpha2;
	r_sq_arr[2] = (4.0/3.0)*alpha2;
	r_sq_arr[3] = (7.0/3.0)*alpha2;
	r_sq_arr[4] = 3.0*alpha2;
	r_sq_arr[5] = 4.0*alpha2;
	r_sq_arr[6] = (13.0/3.0)*alpha2;
	r_sq_arr[7] = (16.0/3.0)*alpha2;

	for (int i = 0; i < 8; ++i) {
		if ((r_sq > r_sq_arr[i] - delta) && (r_sq < r_sq_arr[i] + delta))
			return t_arr[i];
	}

	// onsite = 0.3504

	return 0;	
}

double intralayer_tmdc(double x1, double y1, double z1, double x2, double y2, double z2, int o1, int o2, int mat){

	double onsite[11][11] = 
	   {
			{1.429200, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 1.429200, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.224400, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.449800, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.449800, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -1.849550, 0.000000, 0.000000, -0.308150, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -1.849550, 0.000000, 0.000000, -0.308150, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -2.086400, 0.000000, 0.000000, 1.059700},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.308150, 0.000000, 0.000000, -1.849550, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.308150, 0.000000, 0.000000, -1.849550, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.059700, 0.000000, 0.000000, -2.086400}
	   };
	double H_posd1[11][11] = 
	   {
			{-0.293984, 0.364035, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.364035, 0.045895, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.423286, 0.162693, 0.582001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.162693, 0.390321, 0.353378, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.582001, -0.353378, -0.793004, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.043097, 0.063972, 0.003991, 0.027643, -0.018781, -0.120784},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.063972, -0.106405, -0.035449, 0.018781, 0.113330, -0.044252},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.003991, -0.035449, -0.214512, -0.120784, 0.044252, 0.010388},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.027643, -0.018781, 0.120784, 1.043097, 0.063972, -0.003991},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.018781, 0.113330, 0.044252, -0.063972, -0.106405, 0.035449},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.120784, -0.044252, 0.010388, 0.003991, 0.035449, -0.214512}
	   };
	double H_posd2[11][11] = 
	   {
			{-0.039075, -0.511207, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.216863, -0.209014, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.423286, 0.585374, -0.150104, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.422681, -0.497173, 0.159017, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.431897, 0.865773, 0.094490, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.180971, 0.433777, -0.028704, 0.091909, -0.018323, -0.098716},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.561721, 0.755722, 0.021181, -0.055885, 0.049065, -0.082476},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.032695, 0.014268, -0.214512, -0.022068, -0.126728, 0.010388},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.091909, -0.018323, 0.098716, 0.180971, 0.433777, 0.028704},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.055885, 0.049065, 0.082476, 0.561721, 0.755722, -0.021181},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.022068, 0.126728, 0.010388, 0.032695, -0.014268, -0.214512}
	   };
	double H_posd3[11][11] = 
	   {
			{-0.039075, 0.511207, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.216863, -0.209014, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.423286, -0.585374, -0.150104, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.422681, -0.497173, -0.159017, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.431897, -0.865773, 0.094490, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.180971, -0.433777, 0.028704, 0.091909, 0.018323, 0.098716},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.561721, 0.755722, 0.021181, 0.055885, 0.049065, -0.082476},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.032695, 0.014268, -0.214512, 0.022068, -0.126728, 0.010388},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.091909, 0.018323, -0.098716, 0.180971, -0.433777, -0.028704},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.055885, 0.049065, 0.082476, -0.561721, 0.755722, -0.021181},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.022068, 0.126728, 0.010388, -0.032695, -0.014268, -0.214512}
	   };
	double H_negd1[11][11] = 
	   {
			{-0.293984, -0.364035, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.364035, 0.045895, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.423286, -0.162693, 0.582001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.162693, 0.390321, -0.353378, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.582001, 0.353378, -0.793004, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.043097, -0.063972, -0.003991, 0.027643, 0.018781, 0.120784},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.063972, -0.106405, -0.035449, -0.018781, 0.113330, -0.044252},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003991, -0.035449, -0.214512, 0.120784, 0.044252, 0.010388},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.027643, 0.018781, -0.120784, 1.043097, -0.063972, 0.003991},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.018781, 0.113330, 0.044252, 0.063972, -0.106405, 0.035449},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.120784, -0.044252, 0.010388, -0.003991, 0.035449, -0.214512}
	   };
	double H_negd2[11][11] = 
	   {
			{-0.039075, 0.216863, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.511207, -0.209014, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.423286, 0.422681, -0.431897, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.585374, -0.497173, 0.865773, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.150104, 0.159017, 0.094490, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.180971, 0.561721, -0.032695, 0.091909, -0.055885, 0.022068},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.433777, 0.755722, 0.014268, -0.018323, 0.049065, 0.126728},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.028704, 0.021181, -0.214512, 0.098716, 0.082476, 0.010388},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.091909, -0.055885, -0.022068, 0.180971, 0.561721, 0.032695},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.018323, 0.049065, -0.126728, 0.433777, 0.755722, -0.014268},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.098716, -0.082476, 0.010388, 0.028704, -0.021181, -0.214512}
	   };
	double H_negd3[11][11] = 
	   {
			{-0.039075, -0.216863, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.511207, -0.209014, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.423286, -0.422681, -0.431897, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.585374, -0.497173, -0.865773, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.150104, -0.159017, 0.094490, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.180971, -0.561721, 0.032695, 0.091909, 0.055885, -0.022068},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.433777, 0.755722, 0.014268, 0.018323, 0.049065, 0.126728},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.028704, 0.021181, -0.214512, -0.098716, 0.082476, 0.010388},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.091909, 0.055885, 0.022068, 0.180971, -0.561721, -0.032695},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.018323, 0.049065, -0.126728, -0.433777, 0.755722, -0.014268},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.098716, -0.082476, 0.010388, -0.028704, -0.021181, -0.214512}
	   };
	double H_d4[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{1.083022, 0.971982, 0.620258, 0.641121, -0.250590, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.971982, -0.039326, 0.358106, -0.250590, 0.930478, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.909738, 0.525238, -0.673097, 0.629032, 0.363172, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-1.083022, -0.971982, 0.620258, 0.641121, -0.250590, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.971982, 0.039326, 0.358106, -0.250590, 0.930478, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.909738, 0.525238, 0.673097, -0.629032, -0.363172, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };
	double H_d5[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.600500, 0.000000, 0.000000, 1.075157, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 1.644196, -0.716213, 0.000000, 0.496443, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, -1.050476, -0.673097, 0.000000, -0.726344, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.600500, 0.000000, 0.000000, 1.075157, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, -1.644196, -0.716213, 0.000000, 0.496443, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, -1.050476, 0.673097, 0.000000, 0.726344, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };
	double H_d6[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{1.083022, -0.971982, -0.620258, 0.641121, 0.250590, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.971982, -0.039326, 0.358106, 0.250590, 0.930478, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.909738, 0.525238, -0.673097, -0.629032, 0.363172, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-1.083022, 0.971982, -0.620258, 0.641121, 0.250590, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.971982, 0.039326, 0.358106, 0.250590, 0.930478, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.909738, 0.525238, 0.673097, 0.629032, -0.363172, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };
	double H_d7[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.125743, 0.000000, -0.205739, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.057583, 0.000000, -0.185089, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.125743, 0.000000, -0.205739, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.057583, 0.000000, 0.185089, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };
	double H_d8[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.108897, -0.154304, -0.089087, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.062872, -0.089087, -0.051435, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.057583, 0.160292, 0.092545, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.108897, -0.154304, -0.089087, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.062872, -0.089087, -0.051435, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.057583, -0.160292, -0.092545, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };
	double H_d9[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.108897, -0.154304, 0.089087, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.062872, 0.089087, -0.051435, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.057583, -0.160292, 0.092545, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.108897, -0.154304, 0.089087, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.062872, 0.089087, -0.051435, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.057583, 0.160292, -0.092545, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };
		
	double delta = 0.1;
	double alpha = 3.18;
	double alpha2 = alpha*alpha;
	
	double r_sq_arr[3];
	r_sq_arr[0] = (1.0/3.0)*alpha2;
	r_sq_arr[1] = alpha2;
	r_sq_arr[2] = (4.0/3.0)*alpha2;

	double onsite_arr[11];
	
	
	double r_sq = (x2 - x1)*(x2 - x1) + (y2 - y1)*(y2 - y1);
	
	if (r_sq > r_sq_arr[2] + 2*delta){
		return 0;
	}
	
	
	if (r_sq == 0) {
		return(onsite[o1][o2]);
	}
	
	if ((r_sq > r_sq_arr[0] - delta) && (r_sq < r_sq_arr[0] + delta)){
	
		if (o1 < o2){
			return intralayer_tmdc(x2, y2, z2, x1, y1, z1, o2, o1, mat);
		}
		
		if (y2 > y1) {
			return H_d5[o1][o2];
		}
		
		if (x2 < x1) {
			return H_d4[o1][o2];
		}
		
		if (x2 > x1) {
			return H_d6[o1][o2];
		}
	
	}
	
	if ((r_sq > r_sq_arr[1] - delta) && (r_sq < r_sq_arr[1] + delta)){
		if (y1 == y2) {
			if (x1 < x2) {
				return H_posd1[o1][o2];
			}
			if (x1 > x2) {
				return H_negd1[o1][o2];
			}
		}
		if (y1 < y2) {
			if (x1 < x2) {
				return H_posd2[o1][o2];
			}
			if (x1 > x2) {
				return H_posd3[o1][o2];
			}
		}
		if (y1 > y2) {
			if (x1 < x2) {
				return H_negd3[o1][o2];
			}
			if (x1 > x2) {
				return H_negd2[o1][o2];
			}
		}
	}
	
	if ((r_sq > r_sq_arr[2] - delta) && (r_sq < r_sq_arr[2] + delta)){
	
		if (o1 < o2){
			return intralayer_tmdc(x2, y2, z2, x1, y1, z1, o2, o1, mat);
		}
		
		if (y2 < y1) {
			return H_d7[o1][o2];
		}
		
		if (x2 > x1) {
			return H_d8[o1][o2];
		}
		
		if (x2 < x1) {
			return H_d9[o1][o2];
		}
	}
	

	return 0;
	
}

