/* 
 * File:   intralayer_coupling.cpp
 * Author: Stephen
 * 
 * Created on February 5, 2016, 3:33 PM
 */

 
#include "intralayer_coupling.h"
#include <stdio.h>
#include <cmath>



double intralayer_term(double x1, double y1, double z1, double x2, double y2, double z2, int orbit1, int orbit2, int mat){
	
	// bilayer graphene
	if (mat == 0){
		return intralayer_graphene(x1, y1, z1, x2, y2, z2);
	}
	
	// bilayer tmdc
	if (mat > 0 & mat < 5){
		return intralayer_tmdc(x1, y1, z1, x2, y2, z2, orbit1, orbit2, mat);
	}
	
	printf("failed to find intra-coupling term. \n");
	return 0;
		
}

double intralayer_graphene(double x1, double y1, double z1, double x2, double y2, double z2){

	double delta = 0.1;
	double alpha = 2.4768;
	double alpha2 = alpha*alpha;

	double r_sq = (x2 - x1)*(x2 - x1) + (y2 - y1)*(y2 - y1);

	double t_arr[8];
	t_arr[0] = -2.8922;
	t_arr[1] =  0.2425;
	t_arr[2] = -0.2656;
	t_arr[3] =  0.0235;
	t_arr[4] =  0.0524;
	t_arr[5] = -0.0209;
	t_arr[6] = -0.0148;
	t_arr[7] = -0.0211;

	double r_sq_arr[8];
	r_sq_arr[0] = (1.0/3.0)*alpha2;
	r_sq_arr[1] = alpha2;
	r_sq_arr[2] = (4.0/3.0)*alpha2;
	r_sq_arr[3] = (7.0/3.0)*alpha2;
	r_sq_arr[4] = 3.0*alpha2;
	r_sq_arr[5] = 4.0*alpha2;
	r_sq_arr[6] = (13.0/3.0)*alpha2;
	r_sq_arr[7] = (16.0/3.0)*alpha2;

	for (int i = 0; i < 8; ++i) {
		if ((r_sq > r_sq_arr[i] - delta) && (r_sq < r_sq_arr[i] + delta))
			return t_arr[i];
	}

	// onsite = 0.3504

	return 0;	
}

double intralayer_tmdc(double x1, double y1, double z1, double x2, double y2, double z2, int o1, int o2, int mat){

	double onsite[11][11] = 
	   {
			{1.066800, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 1.066800, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.138000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.087400, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.087400, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -1.598350, 0.000000, 0.000000, -0.308150, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -1.598350, 0.000000, 0.000000, -0.308150, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -1.835200, 0.000000, 0.000000, 1.059700},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.308150, 0.000000, 0.000000, -1.598350, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.308150, 0.000000, 0.000000, -1.598350, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.059700, 0.000000, 0.000000, -1.835200}
	   };
	double H_posd1[11][11] = 
	   {
			{-0.206900, 0.256200, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.256200, 0.032300, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.297900, 0.114500, 0.409600, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.114500, 0.274700, 0.248700, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.409600, -0.248700, -0.558100, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.888650, 0.054500, 0.003400, 0.023550, -0.016000, -0.102900},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.054500, -0.090650, -0.030200, 0.016000, 0.096550, -0.037700},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.003400, -0.030200, -0.182750, -0.102900, 0.037700, 0.008850},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.023550, -0.016000, 0.102900, 0.888650, 0.054500, -0.003400},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.016000, 0.096550, 0.037700, -0.054500, -0.090650, 0.030200},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.102900, -0.037700, 0.008850, 0.003400, 0.030200, -0.182750}
	   };
	double H_posd2[11][11] = 
	   {
			{-0.027500, -0.359777, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.152623, -0.147100, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.297900, 0.411974, -0.105640, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.297474, -0.349900, 0.111913, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.303960, 0.609313, 0.066500, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.154175, 0.369549, -0.024454, 0.078300, -0.015610, -0.084099},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.478549, 0.643825, 0.018044, -0.047610, 0.041800, -0.070264},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.027854, 0.012156, -0.182750, -0.018801, -0.107964, 0.008850},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.078300, -0.015610, 0.084099, 0.154175, 0.369549, 0.024454},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.047610, 0.041800, 0.070264, 0.478549, 0.643825, -0.018044},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.018801, 0.107964, 0.008850, 0.027854, -0.012156, -0.182750}
	   };
	double H_posd3[11][11] = 
	   {
			{-0.027500, 0.359777, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.152623, -0.147100, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.297900, -0.411974, -0.105640, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.297474, -0.349900, -0.111913, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.303960, -0.609313, 0.066500, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.154175, -0.369549, 0.024454, 0.078300, 0.015610, 0.084099},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.478549, 0.643825, 0.018044, 0.047610, 0.041800, -0.070264},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.027854, 0.012156, -0.182750, 0.018801, -0.107964, 0.008850},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.078300, 0.015610, -0.084099, 0.154175, -0.369549, -0.024454},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.047610, 0.041800, 0.070264, -0.478549, 0.643825, -0.018044},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.018801, 0.107964, 0.008850, -0.027854, -0.012156, -0.182750}
	   };
	double H_negd1[11][11] = 
	   {
			{-0.206900, -0.256200, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.256200, 0.032300, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.297900, -0.114500, 0.409600, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.114500, 0.274700, -0.248700, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.409600, 0.248700, -0.558100, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.888650, -0.054500, -0.003400, 0.023550, 0.016000, 0.102900},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.054500, -0.090650, -0.030200, -0.016000, 0.096550, -0.037700},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.003400, -0.030200, -0.182750, 0.102900, 0.037700, 0.008850},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.023550, 0.016000, -0.102900, 0.888650, -0.054500, 0.003400},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.016000, 0.096550, 0.037700, 0.054500, -0.090650, 0.030200},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.102900, -0.037700, 0.008850, -0.003400, 0.030200, -0.182750}
	   };
	double H_negd2[11][11] = 
	   {
			{-0.027500, 0.152623, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.359777, -0.147100, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.297900, 0.297474, -0.303960, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.411974, -0.349900, 0.609313, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.105640, 0.111913, 0.066500, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.154175, 0.478549, -0.027854, 0.078300, -0.047610, 0.018801},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.369549, 0.643825, 0.012156, -0.015610, 0.041800, 0.107964},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.024454, 0.018044, -0.182750, 0.084099, 0.070264, 0.008850},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.078300, -0.047610, -0.018801, 0.154175, 0.478549, 0.027854},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.015610, 0.041800, -0.107964, 0.369549, 0.643825, -0.012156},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.084099, -0.070264, 0.008850, 0.024454, -0.018044, -0.182750}
	   };
	double H_negd3[11][11] = 
	   {
			{-0.027500, -0.152623, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.359777, -0.147100, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.297900, -0.297474, -0.303960, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.411974, -0.349900, -0.609313, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, -0.105640, -0.111913, 0.066500, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.154175, -0.478549, 0.027854, 0.078300, 0.047610, -0.018801},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.369549, 0.643825, 0.012156, 0.015610, 0.041800, 0.107964},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.024454, 0.018044, -0.182750, -0.084099, 0.070264, 0.008850},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.078300, 0.047610, 0.018801, 0.154175, -0.478549, -0.027854},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.015610, 0.041800, -0.107964, -0.369549, 0.643825, -0.012156},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.084099, -0.070264, 0.008850, -0.024454, -0.018044, -0.182750}
	   };
	double H_d4[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{1.005311, 0.902239, 0.575753, 0.595119, -0.232610, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.902239, -0.036504, 0.332411, -0.232610, 0.863713, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.844462, 0.487550, -0.624800, 0.583897, 0.337113, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-1.005311, -0.902239, 0.575753, 0.595119, -0.232610, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.902239, 0.036504, 0.332411, -0.232610, 0.863713, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.844462, 0.487550, 0.624800, -0.583897, -0.337113, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };
	double H_d5[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.557412, 0.000000, 0.000000, 0.998011, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 1.526219, -0.664822, 0.000000, 0.460821, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, -0.975100, -0.624800, 0.000000, -0.674226, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.557412, 0.000000, 0.000000, 0.998011, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, -1.526219, -0.664822, 0.000000, 0.460821, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, -0.975100, 0.624800, 0.000000, 0.674226, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };
	double H_d6[11][11] = 
	   {
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{1.005311, -0.902239, -0.575753, 0.595119, 0.232610, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.902239, -0.036504, 0.332411, 0.232610, 0.863713, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.844462, 0.487550, -0.624800, -0.583897, 0.337113, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-1.005311, 0.902239, -0.575753, 0.595119, 0.232610, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{0.902239, 0.036504, 0.332411, 0.232610, 0.863713, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000},
			{-0.844462, 0.487550, 0.624800, 0.583897, -0.337113, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
	   };

	double delta = 0.1;
	double alpha = 3.18;
	double alpha2 = alpha*alpha;
	
	double r_sq_arr[3];
	r_sq_arr[0] = (1.0/3.0)*alpha2;
	r_sq_arr[1] = alpha2;
	r_sq_arr[2] = (4.0/3.0)*alpha2;

	double onsite_arr[11];
	
	
	double r_sq = (x2 - x1)*(x2 - x1) + (y2 - y1)*(y2 - y1);
	
	
	if (r_sq == 0) {
		return(onsite[o1][o2]);
	}
	
	if ((r_sq > r_sq_arr[0] - delta) && (r_sq < r_sq_arr[0] + delta)){
	
		if (o1 < o2){
			return intralayer_tmdc(x2, y2, z2, x1, y1, z1, o2, o1, mat);
		}
		
		if (y2 > y1) {
			return H_d5[o1][o2];
		}
		
		if (x2 < x1) {
			return H_d4[o1][o2];
		}
		
		if (x2 > x1) {
			return H_d6[o1][o2];
		}
	
	}
	
	if ((r_sq > r_sq_arr[1] - delta) && (r_sq < r_sq_arr[1] + delta)){
		if (y1 == y2) {
			if (x1 < x2) {
				return H_posd1[o1][o2];
			}
			if (x1 > x2) {
				return H_negd1[o1][o2];
			}
		}
		if (y1 < y2) {
			if (x1 < x2) {
				return H_posd2[o1][o2];
			}
			if (x1 > x2) {
				return H_posd3[o1][o2];
			}
		}
		if (y1 > y2) {
			if (x1 < x2) {
				return H_negd3[o1][o2];
			}
			if (x1 > x2) {
				return H_negd2[o1][o2];
			}
		}
	}

	return 0;
	
}

